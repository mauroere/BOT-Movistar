// CASO DE USO DE BIENVENIDA - BASADO EN DIAGRAMA EXACTO "NUEVO BOT 2025.jpg"
// Implementaci√≥n completa del flujo seg√∫n el diagrama MIRO del usuario

// ========================================
// FLUJO DE BIENVENIDA SEG√öN DIAGRAMA ESPEC√çFICO MIRO
// ========================================

const FLUJO_BIENVENIDA_MIRO = {
  // Mensaje inicial de bienvenida (seg√∫n diagrama exacto)
  welcome: {
    messages: [
      "¬°Hola! Te doy la bienvenida a mi canal de atenci√≥n de *Movistar Empresas*. ü§ñ",
      "Por consultas sobre facturaci√≥n, tr√°mites o compra de packs, contactate con la persona autorizada o titular de tu empresa. üìã",
    ],
    options: [
      { text: "TOP / Empresas", action: "top_empresas" },
      { text: "Premium y Emprendedores", action: "premium_emprendedores" },
    ],
  },

  // ========================================
  // RAMA: TOP / EMPRESAS
  // ========================================
  top_empresas: {
    messages: [
      "Perfecto, sos cliente TOP / Empresas.",
      "Para poder brindarte la mejor atenci√≥n, necesito que me digas si sos:",
    ],
    options: [
      { text: "TITULAR", action: "top_titular" },
      { text: "USUARIO", action: "top_usuario" },
      { text: "üîô Volver al men√∫ principal", action: "welcome" },
    ],
  },

  // ========================================
  // TOP EMPRESAS - TITULAR
  // ========================================
  top_titular: {
    messages: [
      "Perfecto, sos TITULAR de la cuenta TOP / Empresas.",
      "¬øEn qu√© horario necesit√°s atenci√≥n?",
    ],
    options: [
      {
        text: "Dentro de horario de atenci√≥n",
        action: "top_titular_dentro_horario",
      },
      {
        text: "Fuera de horario de atenci√≥n",
        action: "top_titular_fuera_horario",
      },
      { text: "üîô Volver", action: "top_empresas" },
    ],
  },

  // ========================================
  // TOP EMPRESAS - TITULAR DENTRO DE HORARIO
  // ========================================
  top_titular_dentro_horario: {
    messages: [
      "Por favor, aguardame un momento y te transfiero con tu representante comercial. üòä",
    ],
    options: [
      { text: "üë§ Conectar con Asesor", action: "conectar_asesor_titular" },
    ],
  },

  // ========================================
  // TOP EMPRESAS - TITULAR FUERA DE HORARIO
  // ========================================
  top_titular_fuera_horario: {
    messages: [
      "¬°Hola! ü§ñ",
      "Nuestro equipo comercial no est√° disponible los feriados, pero puedo ayudarte con estos temas:",
      "‚Ä¢ Para denunciar el robo o p√©rdida de tu equipo, escrib√≠ **Robo**.",
      "‚Ä¢ Si necesit√°s asistencia t√©cnica, escrib√≠ **T√©cnica**.",
      "",
      "Si quer√©s preguntar por *otro tema*, comunicate con tu representante a partir del pr√≥ximo d√≠a h√°bil o consult√° la app Mi Movistar: mov.is/iLEjx",
    ],
    options: [], // Sin opciones - fin del flujo
  },

  // ========================================
  // TOP EMPRESAS - USUARIO
  // ========================================
  top_usuario: {
    messages: [
      "¬°Hola! Te doy la bienvenida a mi canal de atenci√≥n de *Movistar Empresas*. ü§ñ",
      "Por consultas sobre facturaci√≥n, tr√°mites o compra de packs, contactate con la persona autorizada o titular de tu empresa. üìã",
      "‚Ä¢ Desde ac√°, te puedo ayudar con estos temas:",
    ],
    options: [
      { text: "Consulta de Facturaci√≥n", action: "top_usuario_facturacion" },
      { text: "Gesti√≥n Comercial", action: "top_usuario_comercial" },
      { text: "Soporte T√©cnico", action: "top_usuario_soporte" },
      { text: "Ver m√°s opciones", action: "top_usuario_segundo_menu" },
    ],
  },

  // ========================================
  // TOP EMPRESAS - USUARIO - SEGUNDO MENSAJE
  // ========================================
  top_usuario_segundo_menu: {
    messages: ["Tambi√©n pod√©s consultar detalles de tu plan y consumos:"],
    options: [
      { text: "Mi plan", action: "top_usuario_mi_plan" },
      { text: "Consumo de datos", action: "top_usuario_consumo_datos" },
      { text: "Roaming", action: "top_usuario_roaming" },
      { text: "üîô Volver", action: "top_usuario" },
    ],
  },

  // ========================================
  // TOP EMPRESAS - USUARIO - SUBFLUJOS
  // ========================================
  top_usuario_facturacion: {
    messages: [
      "Seleccionaste Consulta de Facturaci√≥n para usuarios TOP/Empresas.",
      "¬øEn qu√© puedo ayudarte con tu facturaci√≥n?",
    ],
    options: [
      { text: "Ver mi √∫ltima factura", action: "top_usuario_ver_factura" },
      { text: "Estado de cuenta", action: "top_usuario_estado_cuenta" },
      { text: "Medios de pago", action: "top_usuario_medios_pago" },
      { text: "üîô Volver", action: "top_usuario" },
    ],
  },

  top_usuario_comercial: {
    messages: [
      "Seleccionaste Gesti√≥n Comercial para usuarios TOP/Empresas.",
      "¬øQu√© gesti√≥n comercial necesit√°s realizar?",
    ],
    options: [
      {
        text: "Consultar servicios",
        action: "top_usuario_consultar_servicios",
      },
      { text: "Modificar plan", action: "top_usuario_modificar_plan" },
      { text: "Agregar servicios", action: "top_usuario_agregar_servicios" },
      { text: "üîô Volver", action: "top_usuario" },
    ],
  },

  top_usuario_soporte: {
    messages: [
      "Seleccionaste Soporte T√©cnico para usuarios TOP/Empresas.",
      "¬øQu√© tipo de soporte t√©cnico necesit√°s?",
    ],
    options: [
      { text: "Problemas de conectividad", action: "top_usuario_conectividad" },
      { text: "Configuraci√≥n de equipos", action: "top_usuario_configuracion" },
      { text: "Reportar falla", action: "top_usuario_reportar_falla" },
      { text: "üîô Volver", action: "top_usuario" },
    ],
  },

  // ========================================
  // TOP EMPRESAS - USUARIO - OPCIONES FINALES
  // ========================================
  top_usuario_mi_plan: {
    messages: [
      "üìã **Mi Plan TOP/Empresas**",
      "Informaci√≥n de tu plan empresarial:",
      "",
      "‚Ä¢ Plan: TOP Empresarial Premium",
      "‚Ä¢ Velocidad: 1GB sim√©trico",
      "‚Ä¢ L√≠neas m√≥viles: 50 incluidas",
      "‚Ä¢ Cloud storage: 1TB empresarial",
      "‚Ä¢ Soporte: 24/7 prioritario",
      "",
      "Para cambios en tu plan, contact√° a tu ejecutivo de cuenta.",
    ],
    options: [], // Sin opciones - fin del flujo
  },

  top_usuario_consumo_datos: {
    messages: [
      "üìä **Consumo de Datos TOP/Empresas**",
      "Resumen de consumo actual:",
      "",
      "üåê **Internet Empresarial:**",
      "‚Ä¢ Consumo del mes: 850GB de 1TB",
      "‚Ä¢ Disponible: 174GB restantes",
      "‚Ä¢ Renovaci√≥n: 15/08/2024",
      "",
      "üì± **Datos M√≥viles Corporativos:**",
      "‚Ä¢ Pool compartido: 2.5TB de 3TB",
      "‚Ä¢ L√≠neas activas: 50/50",
      "‚Ä¢ Promedio por l√≠nea: 50GB",
    ],
    options: [], // Sin opciones - fin del flujo
  },

  top_usuario_roaming: {
    messages: [
      "üåç **Roaming TOP/Empresas**",
      "Informaci√≥n de roaming corporativo:",
      "",
      "‚úÖ **Roaming Habilitado Globalmente**",
      "‚Ä¢ Cobertura: 195 pa√≠ses",
      "‚Ä¢ Tarifa corporativa: Incluida",
      "‚Ä¢ Data roaming: Ilimitado",
      "‚Ä¢ Llamadas: Tarifas preferenciales",
      "",
      "üì± **Consumo Actual:**",
      "‚Ä¢ Este mes: 45GB utilizados",
      "‚Ä¢ Pa√≠ses visitados: 3",
      "‚Ä¢ Costo adicional: $0 (incluido)",
    ],
    options: [], // Sin opciones - fin del flujo
  },

  // ========================================
  // RAMA: PREMIUM Y EMPRENDEDORES
  // ========================================
  premium_emprendedores: {
    messages: [
      "Perfecto, sos cliente Premium y Emprendedores.",
      "Para poder brindarte la mejor atenci√≥n, necesito que me digas:",
    ],
    options: [
      { text: "Pool", action: "premium_pool" },
      { text: "Personalizado", action: "premium_personalizado" },
    ],
  },

  // ========================================
  // MEN√ö "VER OPCIONES" - SEG√öN DIAGRAMA MIRO
  // ========================================
  ver_opciones_menu: {
    messages: [
      "¬°Perfecto! Eleg√≠ Ver opciones y te ayudo a encontrar lo que busc√°s.",
      "¬øCon qu√© te puedo ayudar hoy?",
    ],
    options: [
      { text: "Hablar con asesor√≠a", action: "hablar_asesoria" },
      { text: "Facturas y pagos", action: "facturas_pagos" },
      { text: "Plan, datos y roaming", action: "plan_datos_roaming" },
      { text: "Ayuda t√©cnica", action: "ayuda_tecnica" },
      { text: "Contratar servicios", action: "contratar_servicios" },
      { text: "Consultas y reclamos", action: "consultas_reclamos" },
      { text: "M√°s opciones", action: "mas_opciones" },
      { text: "üîô Volver", action: "premium_emprendedores" },
    ],
  },

  // ========================================
  // IMPLEMENTACI√ìN DEL MEN√ö "VER OPCIONES"
  // ========================================

  // HABLAR CON ASESOR√çA
  hablar_asesoria: {
    messages: [
      "Por favor, aguardame un momento y te transfiero con un representante Comercial üòä",
      "",
      "L√∫ a Vi 21 a 9 y S√ÅB 9 a 13",
      "DOM | FER",
      "",
      "*Nuestro equipo comercial no est√° disponible* en este momento. üïí",
      "",
      "Pod√©s volver a comunicarte los d√≠as h√°biles de *lunes a viernes de 9 a 18 h.*",
      "",
      "Mientras tanto, puedo ayudarte con estos temas:",
    ],
    options: [
      { text: "Facturas y pagos", action: "facturas_pagos" },
      { text: "Plan, datos y roaming", action: "plan_datos_roaming" },
      { text: "Ayuda t√©cnica", action: "ayuda_tecnica" },
      { text: "Contratar servicios", action: "contratar_servicios" },
      { text: "Consultas y reclamos", action: "consultas_reclamos" },
      { text: "M√°s opciones", action: "mas_opciones" },
      { text: "üîô Volver al men√∫ principal", action: "ver_opciones_menu" },
    ],
  },

  // FACTURAS Y PAGOS
  facturas_pagos: {
    messages: [
      "üìÑ **Facturas y Pagos**",
      "¬øQu√© necesit√°s hacer con tu facturaci√≥n?",
    ],
    options: [
      { text: "Ver mi √∫ltima factura", action: "ver_ultima_factura" },
      { text: "Consultar estado de cuenta", action: "estado_cuenta" },
      { text: "Medios de pago", action: "medios_pago" },
      { text: "Realizar un pago", action: "realizar_pago" },
      { text: "Reclamo de facturaci√≥n", action: "reclamo_facturacion" },
      { text: "üîô Volver", action: "ver_opciones_menu" },
    ],
  },

  // PLAN, DATOS Y ROAMING
  plan_datos_roaming: {
    messages: [
      "üì± **Plan, Datos y Roaming**",
      "¬øQu√© informaci√≥n necesit√°s sobre tu plan?",
    ],
    options: [
      { text: "Consultar mi plan actual", action: "consultar_plan" },
      { text: "Ver consumo de datos", action: "consumo_datos" },
      { text: "Agregar o quitar datos", action: "modificar_datos" },
      { text: "Informaci√≥n de roaming", action: "info_roaming" },
      { text: "Cambiar de plan", action: "cambiar_plan" },
      { text: "üîô Volver", action: "ver_opciones_menu" },
    ],
  },

  // AYUDA T√âCNICA
  ayuda_tecnica: {
    messages: [
      "üîß **Ayuda T√©cnica**",
      "¬øQu√© problema t√©cnico necesit√°s resolver?",
    ],
    options: [
      { text: "Problemas de conexi√≥n", action: "problemas_conexion" },
      { text: "Configuraci√≥n de equipos", action: "config_equipos" },
      { text: "Lentitud en internet", action: "lentitud_internet" },
      { text: "Problemas con llamadas", action: "problemas_llamadas" },
      {
        text: "Soporte t√©cnico especializado",
        action: "soporte_especializado",
      },
      { text: "üîô Volver", action: "ver_opciones_menu" },
    ],
  },

  // CONTRATAR SERVICIOS
  contratar_servicios: {
    messages: [
      "üì¶ **Contratar Servicios**",
      "¬øQu√© servicio te interesa contratar?",
    ],
    options: [
      { text: "Nuevas l√≠neas m√≥viles", action: "contratar_lineas" },
      { text: "Internet empresarial", action: "contratar_internet" },
      { text: "Servicios cloud", action: "contratar_cloud" },
      { text: "Paquetes empresariales", action: "contratar_paquetes" },
      { text: "Servicios adicionales", action: "contratar_adicionales" },
      { text: "üîô Volver", action: "ver_opciones_menu" },
    ],
  },

  // CONSULTAS Y RECLAMOS
  consultas_reclamos: {
    messages: ["‚ùì **Consultas y Reclamos**", "¬øEn qu√© te puedo ayudar?"],
    options: [
      { text: "Hacer una consulta general", action: "consulta_general" },
      { text: "Presentar un reclamo", action: "presentar_reclamo" },
      { text: "Seguimiento de reclamo", action: "seguimiento_reclamo" },
      { text: "Consulta sobre servicios", action: "consulta_servicios" },
      { text: "Informaci√≥n de cuenta", action: "info_cuenta" },
      { text: "üîô Volver", action: "ver_opciones_menu" },
    ],
  },

  // M√ÅS OPCIONES
  mas_opciones: {
    messages: ["‚öôÔ∏è **M√°s Opciones**", "Otras opciones disponibles:"],
    options: [
      { text: "Portabilidad num√©rica", action: "portabilidad" },
      { text: "Baja de servicios", action: "baja_servicios" },
      { text: "Informaci√≥n de cobertura", action: "info_cobertura" },
      { text: "Sucursales y horarios", action: "sucursales_horarios" },
      { text: "Contacto ejecutivo de cuenta", action: "contacto_ejecutivo" },
      { text: "üîô Volver", action: "ver_opciones_menu" },
    ],
  },

  // PREMIUM - POOL
  premium_pool: {
    messages: [
      "¬°Hola! Soy tu asistente virtual de Movistar Empresas. Estoy siempre ac√° para ayudarte con tus consultas. ü§ñ",
      "Decime, ¬øpor qu√© servicio quer√©s consultar?",
    ],
    options: [
      { text: "L√≠nea m√≥vil", action: "pool_linea_movil" },
      { text: "L√≠nea fija / Internet", action: "pool_linea_fija_internet" },
      { text: "üîô Volver", action: "premium_emprendedores" },
    ],
  },

  // PREMIUM - PERSONALIZADO
  premium_personalizado: {
    messages: [
      "Perfecto, sos cliente Premium y Emprendedores Personalizado.",
      "Para poder brindarte la mejor atenci√≥n, necesito que me digas si sos:",
    ],
    options: [
      { text: "TITULAR", action: "personalizado_titular" },
      { text: "USUARIO", action: "personalizado_usuario" },
      { text: "üîô Volver", action: "premium_emprendedores" },
    ],
  },

  // ========================================
  // POOL - L√çNEA M√ìVIL
  // ========================================
  pool_linea_movil: {
    messages: [
      "¬°Perfecto! Eleg√≠ Ver opciones y te ayudo a encontrar lo que busc√°s. üëá",
      "Ver opciones",
    ],
    options: [
      { text: "Hablar con asesor√≠a", action: "pool_movil_hablar_asesoria" },
      { text: "Facturas y pagos", action: "pool_movil_facturas_pagos" },
      {
        text: "Plan, datos y roaming",
        action: "pool_movil_plan_datos_roaming",
      },
      { text: "Ayuda t√©cnica", action: "pool_movil_ayuda_tecnica" },
      { text: "Contratar servicios", action: "pool_movil_contratar_servicios" },
      { text: "Celulares y chips", action: "pool_movil_celulares_chips" },
      { text: "M√°s opciones", action: "pool_movil_mas_opciones" },
      { text: "üîô Volver", action: "premium_pool" },
    ],
  },

  // POOL - L√çNEA FIJA / INTERNET
  pool_linea_fija_internet: {
    messages: [
      "¬°Perfecto! Eleg√≠ Ver opciones y te ayudo a encontrar lo que busc√°s. üëá",
      "Ver opciones",
    ],
    options: [
      { text: "Hablar con asesor√≠a", action: "pool_fija_hablar_asesoria" },
      { text: "Facturas y pagos", action: "pool_fija_facturas_pagos" },
      { text: "Ayuda t√©cnica", action: "pool_fija_ayuda_tecnica" },
      { text: "Cambio de titularidad", action: "pool_fija_cambio_titularidad" },
      { text: "Contratar servicios", action: "pool_fija_contratar_servicios" },
      { text: "Baja", action: "pool_fija_baja" },
      { text: "üîô Volver", action: "premium_pool" },
    ],
  },

  // ========================================
  // ========================================
  // PERSONALIZADO - TITULAR
  // ========================================
  personalizado_titular: {
    messages: [
      "¬°Hola! Soy tu asistente virtual de Movistar Empresas. Estoy siempre ac√° para ayudarte con tus consultas. ü§ñ",
      "Toc√° en Ver opciones para conocer todos los temas en los que te puedo asistir. üëá",
      "Ver opciones",
    ],
    options: [
      {
        text: "Hablar con asesor/a",
        action: "personalizado_titular_hablar_asesor",
      },
      {
        text: "Facturas y pagos",
        action: "personalizado_titular_facturas_pagos",
      },
      {
        text: "Plan, datos y roaming",
        action: "personalizado_titular_plan_datos_roaming",
      },
      { text: "Ayuda t√©cnica", action: "personalizado_titular_ayuda_tecnica" },
      {
        text: "Contratar servicios",
        action: "personalizado_titular_contratar_servicios",
      },
      {
        text: "Celulares y chips",
        action: "personalizado_titular_celulares_chips",
      },
      { text: "M√°s opciones", action: "personalizado_titular_mas_opciones" },
      { text: "üîô Volver", action: "premium_personalizado" },
    ],
  },

  // ========================================
  // PERSONALIZADO TITULAR - HABLAR CON ASESOR
  // ========================================
  personalizado_titular_hablar_asesor: {
    messages: [
      "Por favor, aguardame un momento y te transfiero con un representante Comercial. üòä",
    ],
    options: [
      {
        text: "Dentro de horario (LU-VI 9-18)",
        action: "personalizado_titular_dentro_horario",
      },
      {
        text: "Fuera de horario",
        action: "personalizado_titular_fuera_horario",
      },
    ],
  },

  // PERSONALIZADO TITULAR - DENTRO DE HORARIO
  personalizado_titular_dentro_horario: {
    messages: [
      "Conectando con asesor comercial...",
      "Un representante comercial te atender√° en breve. üòä",
    ],
    options: [
      {
        text: "üë§ Conectar con Asesor Comercial",
        action: "conectar_asesor_comercial_personalizado",
      },
    ],
  },

  // PERSONALIZADO TITULAR - FUERA DE HORARIO
  personalizado_titular_fuera_horario: {
    messages: [
      "Nuestro equipo comercial no est√° disponible en este momento. üïí",
      "Pod√©s volver a comunicarte los d√≠as h√°biles,",
      "de lunes a viernes de 9 a 18 h.",
      "",
      "Mientras tanto, se ofrece ayuda autom√°tica con estos temas:",
    ],
    options: [
      {
        text: "Facturas y pagos",
        action: "personalizado_titular_facturas_pagos",
      },
      {
        text: "Plan, datos y roaming",
        action: "personalizado_titular_plan_datos_roaming",
      },
      { text: "Ayuda t√©cnica", action: "personalizado_titular_ayuda_tecnica" },
      {
        text: "Robo o p√©rdida de equipo",
        action: "personalizado_titular_robo_perdida",
      },
      { text: "Men√∫ principal", action: "personalizado_titular" },
    ],
  },

  // ========================================
  // PERSONALIZADO TITULAR - OPCIONES ADICIONALES
  // ========================================
  personalizado_titular_facturas_pagos: {
    messages: [
      "üìÑ **Facturas y Pagos - Personalizado**",
      "¬øQu√© necesit√°s hacer con tu facturaci√≥n?",
    ],
    options: [
      { text: "Ver mi √∫ltima factura", action: "ver_ultima_factura" },
      { text: "Consultar estado de cuenta", action: "estado_cuenta" },
      { text: "Medios de pago", action: "medios_pago" },
      { text: "üîô Volver", action: "personalizado_titular" },
    ],
  },

  personalizado_titular_plan_datos_roaming: {
    messages: [
      "üì± **Plan, Datos y Roaming - Personalizado**",
      "¬øQu√© informaci√≥n necesit√°s sobre tu plan?",
    ],
    options: [
      { text: "Consultar mi plan actual", action: "consultar_plan" },
      { text: "Ver consumo de datos", action: "consumo_datos" },
      { text: "Informaci√≥n de roaming", action: "info_roaming" },
      { text: "üîô Volver", action: "personalizado_titular" },
    ],
  },

  personalizado_titular_ayuda_tecnica: {
    messages: [
      "üîß **Ayuda T√©cnica - Personalizado**",
      "¬øQu√© problema t√©cnico necesit√°s resolver?",
    ],
    options: [
      { text: "Problemas de conexi√≥n", action: "problemas_conexion" },
      { text: "Configuraci√≥n de equipos", action: "config_equipos" },
      { text: "Lentitud en internet", action: "lentitud_internet" },
      { text: "üîô Volver", action: "personalizado_titular" },
    ],
  },

  personalizado_titular_contratar_servicios: {
    messages: [
      "üì¶ **Contratar Servicios - Personalizado**",
      "¬øQu√© servicio te interesa contratar?",
    ],
    options: [
      { text: "Nuevas l√≠neas m√≥viles", action: "contratar_lineas" },
      { text: "Internet empresarial", action: "contratar_internet" },
      { text: "Servicios cloud", action: "contratar_cloud" },
      { text: "üîô Volver", action: "personalizado_titular" },
    ],
  },

  personalizado_titular_celulares_chips: {
    messages: [
      "üì± **Celulares y Chips - Personalizado**",
      "¬øQu√© necesit√°s con celulares y chips?",
    ],
    options: [
      { text: "Comprar celulares", action: "comprar_celulares" },
      { text: "Solicitar chips", action: "solicitar_chips" },
      { text: "Cambio de equipo", action: "cambio_equipo" },
      { text: "üîô Volver", action: "personalizado_titular" },
    ],
  },

  personalizado_titular_mas_opciones: {
    messages: [
      "‚öôÔ∏è **M√°s Opciones - Personalizado**",
      "Otras opciones disponibles:",
    ],
    options: [
      { text: "Portabilidad num√©rica", action: "portabilidad" },
      { text: "Baja de servicios", action: "baja_servicios" },
      { text: "Informaci√≥n de cobertura", action: "info_cobertura" },
      { text: "üîô Volver", action: "personalizado_titular" },
    ],
  },

  personalizado_titular_robo_perdida: {
    messages: [
      "üö® **Robo o P√©rdida de Equipo - Personalizado**",
      "Lamentamos lo ocurrido. Para proceder:",
      "",
      "üìã **Necesitamos:**",
      "‚Ä¢ N√∫mero de l√≠nea afectada",
      "‚Ä¢ Fecha y hora del incidente",
      "‚Ä¢ Denuncia policial (si corresponde)",
      "",
      "üîí **Bloquearemos la l√≠nea inmediatamente**",
    ],
    options: [
      { text: "Confirmar bloqueo", action: "confirmar_bloqueo_personalizado" },
      { text: "M√°s informaci√≥n", action: "info_robo_personalizado" },
      { text: "üîô Volver", action: "personalizado_titular" },
    ],
  },

  // ========================================
  // PERSONALIZADO - USUARIO
  // ========================================
  personalizado_usuario: {
    messages: [
      "¬°Hola! Soy tu asistente virtual de Movistar Empresas. ü§ñ",
      "Toc√° en Ver opciones para conocer todos los temas en los que te puedo asistir. üëá",
      "Ver opciones",
    ],
    options: [
      {
        text: "Facturas y pagos üìÑ",
        action: "personalizado_usuario_facturas_pagos",
      },
      {
        text: "Plan, datos y roaming üåê",
        action: "personalizado_usuario_plan_datos_roaming",
      },
      {
        text: "Celulares y chips üì±",
        action: "personalizado_usuario_celulares_chips",
      },
      {
        text: "Ayuda t√©cnica üõ†",
        action: "personalizado_usuario_ayuda_tecnica",
      },
      {
        text: "Contratar servicios üõç",
        action: "personalizado_usuario_contratar_servicios",
      },
      { text: "Beneficios üéÅ", action: "personalizado_usuario_beneficios" },
      {
        text: "Robo o p√©rdida de equipo",
        action: "personalizado_usuario_robo_perdida",
      },
      { text: "Baja", action: "personalizado_usuario_baja" },
      { text: "M√°s opciones", action: "personalizado_usuario_mas_opciones" },
      { text: "üîô Volver", action: "premium_personalizado" },
    ],
  },

  // ========================================
  // PERSONALIZADO USUARIO - OPCIONES
  // ========================================
  personalizado_usuario_facturas_pagos: {
    messages: [
      "üìÑ **Facturas y Pagos - Usuario Personalizado**",
      "¬øQu√© necesit√°s hacer con tu facturaci√≥n?",
    ],
    options: [
      { text: "Ver mi √∫ltima factura", action: "ver_ultima_factura" },
      { text: "Consultar estado de cuenta", action: "estado_cuenta" },
      { text: "Medios de pago", action: "medios_pago" },
      { text: "üîô Volver", action: "personalizado_usuario" },
    ],
  },

  personalizado_usuario_plan_datos_roaming: {
    messages: [
      "üåê **Plan, Datos y Roaming - Usuario Personalizado**",
      "¬øQu√© informaci√≥n necesit√°s sobre tu plan?",
    ],
    options: [
      { text: "Consultar mi plan actual", action: "consultar_plan" },
      { text: "Ver consumo de datos", action: "consumo_datos" },
      { text: "Informaci√≥n de roaming", action: "info_roaming" },
      { text: "üîô Volver", action: "personalizado_usuario" },
    ],
  },

  personalizado_usuario_celulares_chips: {
    messages: [
      "üì± **Celulares y Chips - Usuario Personalizado**",
      "¬øQu√© necesit√°s con celulares y chips?",
    ],
    options: [
      { text: "Comprar celulares", action: "comprar_celulares" },
      { text: "Solicitar chips", action: "solicitar_chips" },
      { text: "Cambio de equipo", action: "cambio_equipo" },
      { text: "üîô Volver", action: "personalizado_usuario" },
    ],
  },

  personalizado_usuario_ayuda_tecnica: {
    messages: [
      "üõ† **Ayuda T√©cnica - Usuario Personalizado**",
      "¬øQu√© problema t√©cnico necesit√°s resolver?",
    ],
    options: [
      { text: "Problemas de conexi√≥n", action: "problemas_conexion" },
      { text: "Configuraci√≥n de equipos", action: "config_equipos" },
      { text: "Lentitud en internet", action: "lentitud_internet" },
      { text: "üîô Volver", action: "personalizado_usuario" },
    ],
  },

  personalizado_usuario_contratar_servicios: {
    messages: [
      "üõç **Contratar Servicios - Usuario Personalizado**",
      "¬øQu√© servicio te interesa contratar?",
    ],
    options: [
      { text: "Nuevas l√≠neas m√≥viles", action: "contratar_lineas" },
      { text: "Internet empresarial", action: "contratar_internet" },
      { text: "Servicios cloud", action: "contratar_cloud" },
      { text: "üîô Volver", action: "personalizado_usuario" },
    ],
  },

  personalizado_usuario_beneficios: {
    messages: [
      "üéÅ **Beneficios - Usuario Personalizado**",
      "Estos son tus beneficios disponibles:",
      "",
      "‚úÖ **Beneficios Activos:**",
      "‚Ä¢ Descuento 15% en equipos",
      "‚Ä¢ Roaming internacional incluido",
      "‚Ä¢ Soporte t√©cnico prioritario",
      "‚Ä¢ Cloud storage 500GB gratis",
      "",
      "üéØ **Promociones vigentes:**",
      "‚Ä¢ 50% descuento primer mes nuevas l√≠neas",
      "‚Ä¢ Upgrade gratuito de velocidad",
    ],
    options: [
      {
        text: "Ver todos los beneficios",
        action: "todos_beneficios_personalizado",
      },
      {
        text: "Activar promociones",
        action: "activar_promociones_personalizado",
      },
      { text: "üîô Volver", action: "personalizado_usuario" },
    ],
  },

  personalizado_usuario_robo_perdida: {
    messages: [
      "üö® **Robo o P√©rdida de Equipo - Usuario Personalizado**",
      "Lamentamos lo ocurrido. Para proceder:",
      "",
      "üìã **Necesitamos:**",
      "‚Ä¢ N√∫mero de l√≠nea afectada",
      "‚Ä¢ Fecha y hora del incidente",
      "‚Ä¢ Denuncia policial (si corresponde)",
      "",
      "üîí **Bloquearemos la l√≠nea inmediatamente**",
    ],
    options: [
      {
        text: "Confirmar bloqueo",
        action: "confirmar_bloqueo_usuario_personalizado",
      },
      { text: "M√°s informaci√≥n", action: "info_robo_usuario_personalizado" },
      { text: "üîô Volver", action: "personalizado_usuario" },
    ],
  },

  personalizado_usuario_baja: {
    messages: [
      "‚ùå **Baja de Servicios - Usuario Personalizado**",
      "Para proceder con la baja de servicios:",
      "",
      "üìû **Contacto requerido:**",
      "Comunicarse con Retenciones al 0800-555-BAJA",
      "",
      "üïí **Horarios de atenci√≥n:**",
      "Lunes a Viernes de 8:00 a 20:00 hs",
      "",
      "üìã **Documentaci√≥n necesaria:**",
      "‚Ä¢ DNI del titular",
      "‚Ä¢ √öltimo comprobante de pago",
    ],
    options: [
      { text: "Motivos de baja", action: "motivos_baja_personalizado" },
      { text: "Informaci√≥n adicional", action: "info_baja_personalizado" },
      { text: "üîô Volver", action: "personalizado_usuario" },
    ],
  },

  personalizado_usuario_mas_opciones: {
    messages: [
      "‚öôÔ∏è **M√°s Opciones - Usuario Personalizado**",
      "Otras opciones disponibles:",
    ],
    options: [
      { text: "Portabilidad num√©rica", action: "portabilidad" },
      { text: "Informaci√≥n de cobertura", action: "info_cobertura" },
      { text: "Sucursales y horarios", action: "sucursales_horarios" },
      { text: "üîô Volver", action: "personalizado_usuario" },
    ],
  },

  // ========================================
  // PERSONALIZADO - L√çNEA M√ìVIL
  // ========================================
  personalizado_linea_movil: {
    messages: [
      "Seleccionaste L√≠nea m√≥vil personalizada.",
      "¬øQu√© necesit√°s hacer con tus l√≠neas m√≥viles personalizadas?",
    ],
    options: [
      {
        text: "Consulta de Facturaci√≥n",
        action: "personalizado_movil_facturacion",
      },
      { text: "Gesti√≥n Comercial", action: "personalizado_movil_comercial" },
      { text: "Soporte T√©cnico", action: "personalizado_movil_soporte" },
      { text: "Consultas Generales", action: "personalizado_movil_consultas" },
      { text: "üîô Volver", action: "premium_personalizado" },
    ],
  },

  // PERSONALIZADO - L√çNEA FIJA / INTERNET
  personalizado_linea_fija_internet: {
    messages: [
      "Seleccionaste L√≠nea fija / Internet personalizada.",
      "¬øQu√© necesit√°s hacer con tus servicios fijos o de internet personalizados?",
    ],
    options: [
      {
        text: "Consulta de Facturaci√≥n",
        action: "personalizado_fija_facturacion",
      },
      { text: "Gesti√≥n Comercial", action: "personalizado_fija_comercial" },
      { text: "Soporte T√©cnico", action: "personalizado_fija_soporte" },
      { text: "Consultas Generales", action: "personalizado_fija_consultas" },
      { text: "üîô Volver", action: "premium_personalizado" },
    ],
  },

  // ========================================
  // TOP EMPRESAS - SUBFLUJOS
  // ========================================
  top_robo: {
    messages: [
      "üö® **Denuncia de Robo o P√©rdida - TOP Empresas**",
      "Lamentamos lo ocurrido. Para proceder con la denuncia:",
      "",
      "üìã **Informaci√≥n necesaria:**",
      "‚Ä¢ N√∫mero de l√≠nea afectada",
      "‚Ä¢ Fecha y hora aproximada del incidente",
      "‚Ä¢ N√∫mero de denuncia policial (si corresponde)",
      "",
      "üîí **Acciones inmediatas:**",
      "‚Ä¢ Bloqueo preventivo de la l√≠nea",
      "‚Ä¢ Suspensi√≥n de servicios de datos",
      "‚Ä¢ Generaci√≥n de reporte interno",
      "",
      "Un especialista TOP se comunicar√° contigo en las pr√≥ximas 2 horas para completar el proceso.",
    ],
    options: [
      { text: "Confirmar denuncia", action: "top_robo_confirmacion" },
      { text: "M√°s informaci√≥n", action: "top_robo_info" },
      { text: "üîô Volver", action: "top_empresas" },
    ],
  },

  top_tecnica: {
    messages: [
      "üîß **Asistencia T√©cnica TOP Empresas**",
      "¬øQu√© tipo de asistencia t√©cnica necesit√°s?",
    ],
    options: [
      { text: "Falla de conectividad", action: "top_falla_conectividad" },
      { text: "Problema con equipos", action: "top_problema_equipos" },
      { text: "Configuraci√≥n de servicios", action: "top_config_servicios" },
      { text: "Soporte cr√≠tico 24/7", action: "top_soporte_critico" },
      { text: "üîô Volver", action: "top_empresas" },
    ],
  },

  top_consulta_facturacion: {
    messages: [
      "Consulta de Facturaci√≥n TOP / Empresas.",
      "¬øQu√© informaci√≥n necesit√°s sobre tu facturaci√≥n?",
    ],
    options: [
      { text: "Ver √∫ltima factura", action: "top_ver_factura" },
      { text: "Estado de cuenta", action: "top_estado_cuenta" },
      { text: "Medios de pago", action: "top_medios_pago" },
      { text: "Reclamos de facturaci√≥n", action: "top_reclamos_facturacion" },
      { text: "üîô Volver", action: "top_empresas" },
    ],
  },

  top_gestion_comercial: {
    messages: [
      "Gesti√≥n Comercial TOP / Empresas.",
      "¬øQu√© gesti√≥n comercial necesit√°s realizar?",
    ],
    options: [
      { text: "Ampliar servicios", action: "top_ampliar_servicios" },
      { text: "Nuevos productos", action: "top_nuevos_productos" },
      { text: "Modificar servicios", action: "top_modificar_servicios" },
      { text: "Contacto ejecutivo", action: "top_contacto_ejecutivo" },
      { text: "üîô Volver", action: "top_empresas" },
    ],
  },

  top_soporte_tecnico: {
    messages: [
      "Soporte T√©cnico TOP / Empresas.",
      "¬øQu√© tipo de soporte t√©cnico necesit√°s?",
    ],
    options: [
      { text: "Falla de servicio", action: "top_falla_servicio" },
      { text: "Configuraci√≥n", action: "top_configuracion" },
      { text: "Mantenimiento", action: "top_mantenimiento" },
      { text: "Soporte cr√≠tico", action: "top_soporte_critico" },
      { text: "üîô Volver", action: "top_empresas" },
    ],
  },
};

// ========================================
// RESPUESTAS ESPEC√çFICAS DEL FLUJO
// ========================================

const RESPUESTAS_BIENVENIDA = {
  // ========================================
  // RESPUESTAS PARA MEN√ö "VER OPCIONES"
  // ========================================

  // Facturas y Pagos
  ver_ultima_factura:
    "üìÑ Tu √∫ltima factura del per√≠odo 01-31/07/2024 por $45,230.50. Vencimiento: 15/08/2024. ¬øQuer√©s que te la env√≠e por email?",
  estado_cuenta:
    "üìä Estado de cuenta actual: ‚úÖ Al d√≠a. Servicios activos: Internet 100MB, 15 l√≠neas m√≥viles. Pr√≥ximo vencimiento: 15/08/2024.",
  medios_pago:
    "üí≥ Medios de pago disponibles: D√©bito autom√°tico, tarjeta de cr√©dito, transferencia bancaria, RapiPago. ¬øQuer√©s configurar d√©bito autom√°tico?",
  realizar_pago:
    "üí∞ Para realizar un pago pod√©s: 1) D√©bito autom√°tico, 2) Transferencia a CBU 1234567890123456789012, 3) RapiPago con c√≥digo 123456789.",
  reclamo_facturacion:
    "‚ö†Ô∏è Reclamo de facturaci√≥n registrado. Ticket #REC-FACT-240815. Un especialista te contactar√° en 24-48 horas para revisar tu caso.",

  // Plan, Datos y Roaming
  consultar_plan:
    "üì± Tu plan actual: Premium Empresarial 100GB con 15 l√≠neas incluidas. Velocidad: 100MB. Llamadas ilimitadas incluidas.",
  consumo_datos:
    "üìä Consumo actual: 180GB de 200GB disponibles (90% utilizado). Renovaci√≥n: 15/08/2024. ¬øQuer√©s agregar m√°s datos?",
  modificar_datos:
    "üìà Paquetes de datos adicionales: +50GB por $8,500 | +100GB por $15,000 | Ilimitado por $25,000. Activaci√≥n inmediata.",
  info_roaming:
    "üåç Roaming disponible en 195 pa√≠ses. Pack Am√©rica: $15,000/mes. Pack Europa: $22,000/mes. Pack Mundial: $35,000/mes.",
  cambiar_plan:
    "üîÑ Planes disponibles para tu empresa: B√°sico ($28,000), Avanzado ($45,000), Premium ($65,000). ¬øTe interesa alguno en particular?",

  // Ayuda T√©cnica
  problemas_conexion:
    "üåê Verificando tu conexi√≥n... Detectamos posible interferencia. Reinici√° tu router y esper√° 2 minutos. Si persiste, enviamos t√©cnico.",
  config_equipos:
    "‚öôÔ∏è Configuraci√≥n de equipos: 1) Router: IP 192.168.1.1, 2) WiFi: Movistar_Empresa_123, 3) Manual enviado por email.",
  lentitud_internet:
    "üêå Test de velocidad recomendado: movistar.com/speedtest. Si es menor a 80MB, programamos visita t√©cnica sin costo.",
  problemas_llamadas:
    "üìû Problemas de llamadas registrados. Optimizaci√≥n de red aplicada. Si contin√∫a, cambio de SIM gratis en sucursal.",
  soporte_especializado:
    "üîß Derivando a soporte t√©cnico especializado. Un ingeniero te contactar√° en 2-4 horas para an√°lisis detallado.",

  // Contratar Servicios
  contratar_lineas:
    "üì± L√≠neas m√≥viles disponibles: Plan Empresarial desde $4,800/l√≠nea. Portabilidad gratis. ¬øCu√°ntas l√≠neas necesit√°s?",
  contratar_internet:
    "üåê Internet empresarial: 50MB ($18,900), 100MB ($28,500), 200MB ($45,000). Instalaci√≥n gratuita para empresas.",
  contratar_cloud:
    "‚òÅÔ∏è Servicios cloud: Backup autom√°tico, Office 365, hosting web desde $12,000/mes. ¬øQu√© soluci√≥n necesit√°s?",
  contratar_paquetes:
    "üì¶ Paquetes empresariales completos: Internet + M√≥viles + Cloud desde $38,900/mes. Te contacto con un especialista.",
  contratar_adicionales:
    "‚ûï Servicios adicionales: Email corporativo, centralita virtual, monitoreo 24/7. ¬øCu√°l te interesa?",

  // Consultas y Reclamos
  consulta_general:
    "‚ùì Para consultas generales estoy ac√° para ayudarte. Tambi√©n pod√©s llamar al 0800-555-MOVI (6684) las 24 horas.",
  presentar_reclamo:
    "üìù Reclamo registrado. Ticket #REC-GEN-240815. Tiempo de resoluci√≥n: 72 horas h√°biles. Te mantendremos informado por SMS.",
  seguimiento_reclamo:
    "üîç Para seguimiento de reclamos necesito tu n√∫mero de ticket. Tambi√©n pod√©s consultar en mimovistar.com secci√≥n 'Mis Reclamos'.",
  consulta_servicios:
    "‚ÑπÔ∏è Informaci√≥n sobre servicios disponible 24/7. ¬øSobre qu√© servicio espec√≠fico necesit√°s informaci√≥n?",
  info_cuenta:
    "üë§ Informaci√≥n de cuenta: Empresa registrada, 15 servicios activos, ejecutivo asignado: Juan P√©rez (interno 1234).",

  // M√°s Opciones
  portabilidad:
    "üîÑ Portabilidad num√©rica: Proceso gratuito, demora 1-3 d√≠as h√°biles. Necesit√°s: DNI, √∫ltima factura, autorizaci√≥n de titular.",
  cambio_titularidad:
    "üë§ Cambio de titularidad: Proceso requiere documentaci√≥n del titular actual y nuevo titular. Tiempo: 5-7 d√≠as h√°biles. Te derivo con un especialista.",
  baja_servicios:
    "‚ùå Para baja de servicios necesit√°s comunicarte con Retenciones al 0800-555-BAJA. Horario: L√∫-Vi 8-20hs.",
  info_cobertura:
    "üì° Cobertura disponible en tu zona: 4G+ 98%, 5G 45%, Fibra √≥ptica disponible. ¬øQuer√©s verificar una direcci√≥n espec√≠fica?",
  sucursales_horarios:
    "üè¢ Sucursal m√°s cercana: Av. Corrientes 1234, CABA. Horario: L√∫-Vi 9-18hs, S√°b 9-13hs. Tel: (011) 4000-1234.",
  contacto_ejecutivo:
    "üë®‚Äçüíº Tu ejecutivo de cuenta Juan P√©rez te contactar√° en las pr√≥ximas 2 horas al n√∫mero registrado.",

  // Respuestas originales para TOP/Empresas - Facturaci√≥n
  top_ver_factura:
    "üìÑ Accediendo a tu √∫ltima factura TOP/Empresas. Factura N¬∫ 2024-08-001234 por $125,430.50. Vencimiento: 15/08/2024.",
  top_estado_cuenta:
    "üìä Estado de cuenta TOP/Empresas: Saldo al d√≠a. Servicios activos: Internet 1GB, 50 l√≠neas m√≥viles, Cloud empresarial.",
  top_medios_pago:
    "üí≥ Medios de pago disponibles para clientes TOP: D√©bito autom√°tico, transferencia, cheques. Descuentos especiales aplicables.",
  top_reclamos:
    "‚ö†Ô∏è Generando ticket de reclamo prioritario TOP/Empresas. Ref: #REC-TOP-240815. Un especialista te contactar√° en 30 minutos.",

  // Respuestas para TOP/Empresas - Soporte
  top_falla_servicio:
    "üö® Falla de servicio TOP registrada. Ticket cr√≠tico #INC-TOP-240815. SLA: Resoluci√≥n en 2 horas. NOC notificado.",
  top_configuracion:
    "‚öôÔ∏è Soporte especializado TOP para configuraci√≥n. Te derivo con ingeniero senior. Contacto inmediato.",
  top_mantenimiento:
    "üîß Mantenimientos programados TOP: Ventana 02:00-05:00 AM. Pr√≥ximo: 20/08/2024. Notificaci√≥n 48hs antes.",
  top_soporte_critico:
    "üÜò SOPORTE CR√çTICO TOP activado. Escalamiento inmediato a NOC. Ingeniero de guardia contactar√° en 10 minutos.",

  // Respuestas para TOP/Empresas - Servicios
  top_internet_dedicado:
    "üåê Internet dedicado TOP: Velocidades 500MB-10GB. Fibra √≥ptica redundante. SLA 99.95%. Soporte 24/7.",
  top_cloud:
    "‚òÅÔ∏è Soluciones cloud TOP: AWS/Azure integrado, backup autom√°tico, disaster recovery, monitoreo 24/7.",
  top_conectividad:
    "üîó Conectividad TOP: MPLS, SD-WAN, VPN sitio-a-sitio, enlaces backup, QoS garantizado.",
  top_gestionados:
    "üõ†Ô∏è Servicios gestionados TOP: NOC dedicado, monitoreo proactivo, mantenimiento preventivo, reporter√≠a ejecutiva.",

  // Respuestas para TOP/Empresas - Comercial
  top_ampliar_servicios:
    "üìà Ampliaci√≥n de servicios TOP. Te contacto con tu Account Manager dedicado para an√°lisis personalizado.",
  top_nuevos_productos:
    "üÜï Productos TOP disponibles: 5G empresarial, IoT, ciberseguridad avanzada, analytics. Consulta especializada.",
  top_renovacion:
    "üìã Renovaci√≥n TOP: Condiciones preferenciales, descuentos por lealtad. Tu ejecutivo te contactar√° hoy.",
  top_ejecutivo:
    "üë®‚Äçüíº Contactando a tu ejecutivo de cuenta TOP dedicado. Atenci√≥n personalizada en 15 minutos.",

  // Respuestas para Premium/Emprendedores - Facturaci√≥n
  premium_ver_factura:
    "üìÑ Tu √∫ltima factura Premium: $45,230.50. Per√≠odo: 01-31/07/2024. Descarga disponible en Mi Movistar.",
  premium_estado_cuenta:
    "üìä Estado Premium: Al d√≠a. Servicios: Internet 100MB, 15 l√≠neas m√≥viles, Cloud 500GB. Pr√≥ximo vto: 15/08.",
  premium_medios_pago:
    "üí≥ Medios de pago Premium: D√©bito autom√°tico, tarjeta, transferencia, RapiPago. Descuento 5% d√©bito autom√°tico.",
  premium_consultas_fact:
    "‚ùì Consultas de facturaci√≥n Premium. ¬øSobre qu√© concepto necesitas informaci√≥n? Un especialista te ayudar√°.",

  // Respuestas para Premium/Emprendedores - Soporte
  premium_conexion:
    "üåê Problemas de conexi√≥n Premium registrados. Ticket #INC-PREM-240815. Soluci√≥n estimada: 4 horas.",
  premium_config_servicios:
    "‚öôÔ∏è Configuraci√≥n de servicios Premium. Te gu√≠o paso a paso o derivo con t√©cnico especializado.",
  premium_consultas_tec:
    "üîß Consultas t√©cnicas Premium. Chat t√©cnico disponible o llamada programada seg√∫n tu preferencia.",
  premium_reportar_falla:
    "‚ö†Ô∏è Falla reportada Premium. Ticket #FALL-PREM-240815. Seguimiento por SMS y email.",

  // Respuestas para Premium/Emprendedores - Servicios
  premium_planes_internet:
    "üåê Planes internet Premium: 50MB, 100MB, 200MB. Fibra √≥ptica. Instalaci√≥n gratuita emprendedores.",
  premium_moviles:
    "üì± Servicios m√≥viles Premium: Planes desde 10GB. Roaming incluido. Descuentos corporativos disponibles.",
  premium_digitales:
    "üíª Soluciones digitales Premium: Office 365, Google Workspace, backup cloud, hosting web.",
  premium_planes_emprendedores:
    "üöÄ Planes emprendedores: Internet + m√≥vil + digital desde $25.000. Kit gratuito primeros 3 meses.",

  // Respuestas para Premium/Emprendedores - Comercial
  premium_contratar:
    "üìù Contrataci√≥n Premium: Te contacto con ejecutivo comercial para cotizaci√≥n personalizada.",
  premium_cambiar_plan:
    "üîÑ Cambio de plan Premium: An√°lisis de uso y recomendaci√≥n del mejor plan para tu negocio.",
  premium_promociones:
    "üéâ Promociones Premium vigentes: 50% desc. primer mes, instalaci√≥n gratis, equipos sin costo.",
  premium_asesoramiento:
    "üí° Asesoramiento Premium: Consultor√≠a gratuita para optimizar tus servicios de telecomunicaciones.",

  // ========================================
  // RESPUESTAS FINALES E2E - ACCIONES CONCRETAS
  // ========================================

  // TOP EMPRESAS - Respuestas finales de Facturaci√≥n
  top_enviar_factura_email:
    "üìß ¬°Listo! Tu factura TOP se envi√≥ a tu email corporativo registrado. Llegar√° en 5 minutos. Ticket: #EMAIL-TOP-240815",
  top_enviar_factura_sms:
    "üì± Enlace de descarga enviado por SMS al n√∫mero registrado. V√°lido por 24 horas. Ref: #SMS-TOP-240815",
  top_descargar_factura:
    "üíª Preparando descarga de PDF... ‚¨áÔ∏è DESCARGA INICIADA. Factura TOP N¬∫ 2024-08-001234.pdf (2.1 MB)",
  top_especialista_facturacion:
    "üìû Conectando con especialista en facturaci√≥n TOP... Tu ejecutivo Juan P√©rez te llamar√° en 10 minutos al n√∫mero registrado.",

  top_consumos_detallados:
    "üìä CONSUMOS DETALLADOS TOP:\nüåê Internet: 8.2TB de 10TB\nüì± M√≥viles: 2,840 min de 5,000\n‚òÅÔ∏è Cloud: 145GB de 500GB\nüìû Fijos: 1,200 min",
  top_proyeccion_factura:
    "üí∞ PROYECCI√ìN PR√ìXIMA FACTURA:\nBasado en uso actual: $128,450\nPromedio √∫ltimos 3 meses: $125,680\nFecha estimada: 15/09/2024",
  top_historico_consumos:
    "üìà HIST√ìRICO √öLTIMOS 6 MESES:\nEnero: $122,300 | Febrero: $119,800\nMarzo: $125,600 | Abril: $124,200\nMayo: $126,100 | Junio: $125,430",
  top_resumen_ejecutivo:
    "üîÑ Generando resumen ejecutivo TOP... Ser√° enviado a gerencia@tuempresa.com en 15 minutos. Incluye: tendencias, optimizaciones y recomendaciones.",

  top_agregar_medio_pago:
    "‚ûï Enviando formulario seguro para nuevo medio de pago TOP a tu email. Link v√°lido 48hs. Certificaci√≥n PCI DSS.",
  top_modificar_debito:
    "‚úèÔ∏è Modificaci√≥n de d√©bito autom√°tico TOP programada. Cambios efectivos pr√≥ximo per√≠odo. Confirmaci√≥n por email en 2 horas.",
  top_ver_metodos_pago:
    "üìã M√âTODOS DE PAGO ACTIVOS:\nüí≥ Cuenta corriente BBVA **1234 (Principal)\nüè¶ Transferencia autom√°tica (Backup)\nüìÑ Cuenta corporativa Santander **5678",
  top_pago_corporativo:
    "üí≥ Configurando pago corporativo TOP con condiciones especiales. Account Manager te contactar√° para configuraci√≥n avanzada.",

  top_reclamo_importe:
    "üí∞ RECLAMO IMPORTE TOP registrado. Ticket cr√≠tico #REC-IMP-TOP-240815. Auditor√≠a inmediata. Resoluci√≥n SLA: 24 horas.",
  top_reclamo_servicios:
    "üìã RECLAMO SERVICIOS TOP registrado. Ref: #REC-SERV-240815. Revisi√≥n t√©cnica y comercial. Te contactamos en 2 horas.",
  top_reclamo_fechas:
    "üìÖ RECLAMO FECHAS TOP registrado. Ticket: #REC-FECHA-240815. Ajuste autom√°tico pr√≥xima factura si procede.",
  top_auditoria_cuenta:
    "üîç AUDITOR√çA COMPLETA TOP iniciada. Especialista asignado: Mar√≠a Gonz√°lez. Informe completo en 48 horas v√≠a email seguro.",

  // TOP EMPRESAS - Respuestas finales de Soporte
  top_sin_conectividad:
    "üåê FALLA CR√çTICA registrada. NOC TOP activado. Ticket: #CONEX-TOP-240815. Ingeniero en sitio dispatch: 30 minutos. SLA: 2 horas.",
  top_velocidad_reducida:
    "üì∂ DEGRADACI√ìN DE VELOCIDAD TOP detectada. Diagn√≥stico autom√°tico iniciado. Optimizaci√≥n en curso. Monitoreo 24h activo.",
  top_problemas_voz:
    "üìû PROBLEMAS VOZ TOP escalado. Ingeniero de telefon√≠a asignado. An√°lisis de calidad en curso. Update cada 30 min.",
  top_falla_cloud:
    "‚òÅÔ∏è FALLA CLOUD TOP reportada. Escalamiento inmediato a AWS/Azure. Backup autom√°tico activado. Recovery time: <1 hora.",

  top_config_red:
    "üñ•Ô∏è Configuraci√≥n de equipos de red TOP programada. Ingeniero senior en sitio ma√±ana 9 AM. Configuraci√≥n remota disponible YA.",
  top_config_moviles:
    "üì± Configuraci√≥n masiva de dispositivos TOP. MDM corporativo listo. 50 dispositivos configurados remotamente en 2 horas.",
  top_config_cloud:
    "‚òÅÔ∏è Configuraci√≥n servicios cloud TOP con especialista certificado. Sesi√≥n dedicada programada para hoy 15:00 hs.",
  top_config_seguridad:
    "üîê Configuraci√≥n seguridad TOP con expert en ciberseguridad. Firewall, VPN y pol√≠ticas. Sesi√≥n cr√≠tica HOY.",

  // TOP EMPRESAS - Respuestas finales de Servicios
  top_aumentar_velocidad:
    "‚ö° UPGRADE VELOCIDAD TOP: Disponible upgrade inmediato 1GB‚Üí5GB. Implementaci√≥n sin corte. Costo: $45,000/mes adicionales.",
  top_redundancia:
    "üîÑ REDUNDANCIA TOP: Enlaces backup disponibles. Fibra √≥ptica redundante + 4G backup. SLA 99.99%. Implementaci√≥n: 48hs.",
  top_monitoreo_real:
    "üìä MONITOREO 24/7 TOP activo. Dashboard ejecutivo en tiempo real. Alertas proactivas. Portal: monitor.movistar-top.com",
  top_cotizar_upgrade:
    "üí∞ COTIZACI√ìN UPGRADE TOP generada. Account Manager te enviar√° propuesta personalizada en 2 horas. Condiciones preferenciales aplicadas.",

  top_backup_cloud:
    "üíæ BACKUP CLOUD TOP: RPO 15 min, RTO 30 min. 99.99% disponibilidad. Disaster Recovery geogr√°fico incluido.",
  top_migracion_cloud:
    "üè¢ MIGRACI√ìN CLOUD TOP con zero downtime. Plan de migraci√≥n personalizado. Project Manager asignado: Carlos Ruiz.",
  top_seguridad_cloud:
    "üîê SEGURIDAD CLOUD TOP: Certificaciones ISO 27001, SOC 2. Encryption end-to-end. Compliance GDPR incluido.",
  top_escalabilidad_cloud:
    "üìà AUTO-SCALING TOP configurado. Recursos din√°micos seg√∫n demanda. Optimizaci√≥n de costos autom√°tica 24/7.",

  // TOP EMPRESAS - Respuestas finales de Comercial
  top_mas_ancho_banda:
    "üìà AMPLIACI√ìN ANCHO DE BANDA TOP: De 1GB a 5GB disponible YA. Upgrade sin corte. Account Manager confirma en 1 hora.",
  top_mas_lineas:
    "üì± AMPLIACI√ìN L√çNEAS TOP: +20 l√≠neas corporativas disponibles. Activaci√≥n en 24hs. Descuento por volumen aplicado.",
  top_nuevas_sucursales:
    "üè¢ NUEVAS SUCURSALES TOP: Infraestructura para 5 nuevas locaciones. Project Manager asignado. Cronograma en 48hs.",
  top_mas_cloud:
    "‚òÅÔ∏è AMPLIACI√ìN CLOUD TOP: Storage ilimitado, m√°s instancias. Scaling autom√°tico. Propuesta executive en 24hs.",

  top_5g_empresarial:
    "üì° 5G EMPRESARIAL TOP disponible en tu zona. Velocidades hasta 1Gbps m√≥vil. Beta testing disponible. Priority network.",
  top_iot_conectividad:
    "üîå IoT CONNECTIVITY TOP: 10,000 dispositivos IoT incluidos. Dashboard centralizado. Gesti√≥n remota total.",
  top_ciberseguridad:
    "üõ°Ô∏è CIBERSEGURIDAD TOP: SOC 24/7, threat intelligence, incident response. Consultor√≠a gratuita con expert.",
  top_business_intelligence:
    "üìä BUSINESS INTELLIGENCE TOP: Analytics avanzado, dashboards ejecutivos, machine learning. Consultor√≠a included.",

  // PREMIUM EMPRENDEDORES - Respuestas finales de Facturaci√≥n
  premium_enviar_factura_email:
    "üìß Factura Premium enviada a tu email en 5 minutos. Formato PDF descargable. Ref: #EMAIL-PREM-240815",
  premium_descargar_movil:
    "üì± Link de descarga enviado por SMS. V√°lido 48 horas. Factura optimizada para m√≥vil. Ref: #MOV-PREM-240815",
  premium_explicar_conceptos:
    "üí¨ Te explico cada concepto de tu factura Premium:\nüìû Abono b√°sico: $15,200\nüì± Excedentes: $8,430\nüåê Internet: $18,600\n‚òÅÔ∏è Servicios cloud: $3,000",
  premium_contactar_soporte:
    "üìû Te contacto con soporte Premium. Especialista Laura Martinez te llamar√° en 20 minutos para ayudarte.",

  premium_detalle_consumos:
    "üìä DETALLE CONSUMOS PREMIUM:\nüåê Internet: 180GB de 200GB\nüì± Llamadas: 840 min de 1000\nüìß Email: 15GB de 50GB\n‚òÅÔ∏è Storage: 320GB de 500GB",
  premium_proximo_vencimiento:
    "üí∞ PR√ìXIMO VENCIMIENTO: 15/08/2024\nImporte estimado: $47,100\nD√≠as restantes: 3 d√≠as\nüí° Tip: Activa d√©bito autom√°tico y ahorra 5%",
  premium_tendencia_uso:
    "üìà TENDENCIA √öLTIMOS 3 MESES:\nPromedio mensual: $45,500\nPico de uso: Abril ($52,200)\nTendencia: Estable ‚úÖ",
  premium_actualizar_datos:
    "üîÑ Actualizando datos de cuenta Premium... Informaci√≥n sincronizada. Cambios reflejados en pr√≥xima factura.",

  // PREMIUM EMPRENDEDORES - Respuestas finales de Soporte
  premium_sin_internet:
    "üåê FALLA INTERNET Premium registrada. Ticket: #INT-PREM-240815. T√©cnico en ruta. ETA: 2-4 horas. Update por SMS.",
  premium_lentitud:
    "üêå LENTITUD reportada Premium. Diagn√≥stico remoto en curso... Optimizaci√≥n aplicada. Test de velocidad: movistar.com/speedtest",
  premium_problemas_wifi:
    "üì∂ WIFI Premium: Enviando configuraci√≥n optimizada por SMS. Si persiste, t√©cnico en 24-48hs. Autodiagn√≥stico disponible.",
  premium_llamadas_cortadas:
    "üìû LLAMADAS Premium: Optimizaci√≥n de red aplicada. Si contin√∫a, cambio de SIM gratis en sucursal m√°s cercana.",

  premium_config_email:
    "üìß EMAIL CORPORATIVO Premium: Configuraci√≥n step-by-step enviada por email. Soporte t√©cnico disponible 8-20hs.",
  premium_config_lineas:
    "üì± L√çNEAS Premium: Configuraci√≥n masiva disponible. Portal autogesti√≥n: mimovistar.com/premium. Video-tutorial incluido.",
  premium_config_portal:
    "üåê PORTAL WEB Premium: Credenciales y gu√≠a enviadas por email. Hosting incluido 12 meses. Soporte 8-20hs.",
  premium_config_almacenamiento:
    "‚òÅÔ∏è CLOUD STORAGE Premium: 500GB configurados. Sync autom√°tico activado. App m√≥vil: Movistar Cloud Premium.",

  // PREMIUM EMPRENDEDORES - Respuestas finales de Servicios
  premium_oficina_pequena:
    "üè† PLAN OFICINA PEQUE√ëA: 100MB + 5 l√≠neas + Cloud 200GB = $28,900/mes. Instalaci√≥n gratis. ¬øTe interesa?",
  premium_oficina_mediana:
    "üè¢ PLAN OFICINA MEDIANA: 200MB + 15 l√≠neas + Cloud 500GB = $45,600/mes. Kit emprendedor incluido.",
  premium_startups:
    "üöÄ PLAN STARTUPS: 50MB + 10 l√≠neas + Cloud ilimitado = $35,200/mes. 3 meses 50% descuento!",
  premium_plan_escalable:
    "üìà PLAN ESCALABLE: Crece con tu negocio. Desde $18,900 hasta $65,000. Sin permanencia. Flexible total.",

  premium_lineas_nuevas:
    "üì± L√çNEAS NUEVAS Premium: Activaci√≥n en 2 horas. Portabilidad gratis. SIM entrega inmediata en sucursal.",
  premium_aumentar_datos:
    "‚¨ÜÔ∏è DATOS Premium: Upgrade inmediato disponible. 10GB‚Üí25GB por $8,500 adicionales. Activaci√≥n YA.",
  premium_roaming:
    "üåç ROAMING Premium: 195 pa√≠ses incluidos. Tarifas preferenciales. Pack viajero desde $15,000/mes.",
  premium_plan_familiar:
    "üë• PLAN FAMILIAR EMPRESARIAL: 5 l√≠neas compartidas + beneficios. Desde $32,400/mes. Gesti√≥n centralizada.",

  // PREMIUM EMPRENDEDORES - Respuestas finales de Comercial
  premium_pack_completo:
    "üì¶ PACK EMPRENDEDOR COMPLETO: Internet 100MB + 10 l√≠neas + Cloud + Email = $38,900/mes. üéÅ Kit gratis!",
  premium_solo_internet:
    "üåê SOLO INTERNET Premium: Planes desde $18,900 (50MB) hasta $35,600 (200MB). Instalaci√≥n gratis emprendedores.",
  premium_solo_moviles:
    "üì± SOLO M√ìVILES Premium: Desde 5 l√≠neas $22,400/mes. Ilimitado empresarial $4,800/l√≠nea. Sin permanencia.",
  premium_servicios_digitales:
    "‚òÅÔ∏è SERVICIOS DIGITALES Premium: Cloud + Email + Web + Backup = $12,900/mes. Todo en uno para emprendedores.",

  premium_upgrade_plan:
    "‚¨ÜÔ∏è UPGRADE Premium: Plan superior disponible. M√°s velocidad y beneficios. Migraci√≥n sin costos. Activo en 24hs.",
  premium_downgrade_plan:
    "‚¨áÔ∏è DOWNGRADE Premium: Plan ajustado a tu presupuesto. Mantienes servicios esenciales. Cambio en pr√≥ximo per√≠odo.",
  premium_cambiar_tipo:
    "üîÑ CAMBIO TIPO PLAN Premium: An√°lisis de uso completado. Te recomiendo Plan H√≠brido. Ahorro: 15% mensual.",
  premium_agregar_servicios:
    "‚ûï SERVICIOS ADICIONALES Premium: Cloud storage, l√≠neas extra, hosting disponibles. Configuraci√≥n inmediata.",
};

// ========================================
// FUNCI√ìN PARA LIMPIAR FLUJOS ANTERIORES Y CARGAR EL NUEVO
// ========================================
function limpiarYCargarFlujoBienvenida() {
  // Limpiar flujos anteriores
  if (window.whatsappBot && window.whatsappBot.botFlows) {
    // Mantener solo la estructura base, eliminar flujos personalizados
    window.whatsappBot.botFlows = {};
  }

  // Cargar el nuevo flujo de bienvenida
  Object.keys(FLUJO_BIENVENIDA_MIRO).forEach((flowName) => {
    if (window.addMiroFlow) {
      window.addMiroFlow(flowName, FLUJO_BIENVENIDA_MIRO[flowName]);
    }
  });

  console.log("‚úÖ Flujo de bienvenida NUEVO BOT 2025 cargado");
  console.log("üóëÔ∏è Flujos anteriores eliminados");
  console.log(
    `üìä Nuevo flujo con ${Object.keys(FLUJO_BIENVENIDA_MIRO).length} pasos`
  );
}

// ========================================
// INTEGRACI√ìN CON EL BOT PRINCIPAL
// ========================================
document.addEventListener("DOMContentLoaded", () => {
  setTimeout(() => {
    // Hacer las respuestas disponibles globalmente
    window.RESPUESTAS_BIENVENIDA = RESPUESTAS_BIENVENIDA;

    // Limpiar y cargar el nuevo flujo
    limpiarYCargarFlujoBienvenida();

    // Extender respuestas autom√°ticas
    if (window.whatsappBot) {
      const originalProcessAction = window.whatsappBot.processAction;
      window.whatsappBot.processAction = function (action) {
        if (RESPUESTAS_BIENVENIDA[action]) {
          const typingIndicator = this.addTypingIndicator();
          setTimeout(() => {
            this.removeTypingIndicator(typingIndicator);
            this.addMessage(RESPUESTAS_BIENVENIDA[action], "received");

            // Despu√©s de respuestas autom√°ticas, volver al flujo correspondiente
            if (action.includes("top_")) {
              if (
                action.includes("facturacion") ||
                action.includes("ver_factura") ||
                action.includes("estado_cuenta") ||
                action.includes("medios_pago") ||
                action.includes("reclamos")
              ) {
                setTimeout(() => this.executeFlow("top_facturacion"), 3000);
              } else if (
                action.includes("soporte") ||
                action.includes("falla") ||
                action.includes("configuracion") ||
                action.includes("mantenimiento") ||
                action.includes("critico")
              ) {
                setTimeout(() => this.executeFlow("top_soporte"), 3000);
              } else if (
                action.includes("servicios") ||
                action.includes("internet") ||
                action.includes("cloud") ||
                action.includes("conectividad") ||
                action.includes("gestionados")
              ) {
                setTimeout(() => this.executeFlow("top_servicios"), 3000);
              } else if (
                action.includes("comercial") ||
                action.includes("ampliar") ||
                action.includes("nuevos") ||
                action.includes("renovacion") ||
                action.includes("ejecutivo")
              ) {
                setTimeout(() => this.executeFlow("top_comercial"), 3000);
              }
            } else if (action.includes("premium_")) {
              if (
                action.includes("facturacion") ||
                action.includes("ver_factura") ||
                action.includes("estado_cuenta") ||
                action.includes("medios_pago") ||
                action.includes("consultas_fact")
              ) {
                setTimeout(() => this.executeFlow("premium_facturacion"), 3000);
              } else if (
                action.includes("soporte") ||
                action.includes("conexion") ||
                action.includes("config") ||
                action.includes("consultas_tec") ||
                action.includes("reportar_falla")
              ) {
                setTimeout(() => this.executeFlow("premium_soporte"), 3000);
              } else if (
                action.includes("servicios") ||
                action.includes("planes") ||
                action.includes("moviles") ||
                action.includes("digitales") ||
                action.includes("emprendedores")
              ) {
                setTimeout(() => this.executeFlow("premium_servicios"), 3000);
              } else if (
                action.includes("comercial") ||
                action.includes("contratar") ||
                action.includes("cambiar") ||
                action.includes("promociones") ||
                action.includes("asesoramiento")
              ) {
                setTimeout(() => this.executeFlow("premium_comercial"), 3000);
              }
            }
          }, 1500);
        } else {
          originalProcessAction.call(this, action);
        }
      };
    }

    console.log("üéØ Bot configurado con flujo NUEVO BOT 2025 completo");
  }, 1500);
});

// ========================================
// FUNCIONES DE UTILIDAD
// ========================================
window.reiniciarFlujoBienvenida = function () {
  if (window.whatsappBot) {
    window.whatsappBot.executeFlow("welcome");
  }
};

window.testearFlujo = function (nombreFlujo) {
  if (FLUJO_BIENVENIDA_MIRO[nombreFlujo]) {
    window.testFlow(nombreFlujo);
  } else {
    console.log("‚ùå Flujo no encontrado:", nombreFlujo);
    console.log("üìã Flujos disponibles:", Object.keys(FLUJO_BIENVENIDA_MIRO));
  }
};

// Funciones espec√≠ficas para testing
window.testTOP = function () {
  if (window.whatsappBot) {
    window.whatsappBot.executeFlow("top_empresas");
  }
};

window.testPremium = function () {
  if (window.whatsappBot) {
    window.whatsappBot.executeFlow("premium_emprendedores");
  }
};

// Export para uso modular
if (typeof module !== "undefined" && module.exports) {
  module.exports = {
    FLUJO_BIENVENIDA_MIRO,
    RESPUESTAS_BIENVENIDA,
    limpiarYCargarFlujoBienvenida,
  };
}
